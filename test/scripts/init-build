#!/usr/bin/env bash

# turn the (empty) working directory into a build environment;
# called in an empty build directory;
# called before test/scripts/test

set -euo pipefail

cnl_dir=$(
  cd "$(dirname "$0")"/../..
  pwd
)

# get dependencies ready
conan install \
  --build missing \
  --options test=all \
  --profile "${cnl_dir}/.github/conan/profiles/linux" \
  "$@" \
  "${cnl_dir}"

# configure build system
conan build --configure "${cnl_dir}"
